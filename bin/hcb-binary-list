#!/bin/bash

ROOT_DIR="$HOME/.hashicorp/hcb"
BIN_DIR="$ROOT_DIR/bin"
BINARY_DIR="$ROOT_DIR/binaries"

VALID_APPS="consul nomad terraform vault"

APP=$1

valid_app=0
for a in $VALID_APPS; do
  if [ "$a" = "$APP" ]; then
    valid_app=1
    break
  fi
done

if [ "$valid_app" != "1" ]; then
  echo "Please specify a valid app name: ${VALID_APPS}"
  exit 1
fi

current_version=""
if [ -f ${ROOT_DIR}/.${APP}.current ]; then
  current_version=$(cat ${ROOT_DIR}/.${APP}.current)
fi

for version in $(ls -1b ${BINARY_DIR}/${APP}); do
  if [ "$version" = "$current_version" ]; then
    echo "* ${version}"
  else
    echo "  ${version}"
  fi
done
